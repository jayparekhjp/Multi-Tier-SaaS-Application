<!DOCTYPE html>
<html lang="en">
   <head>
      <!-- -->    
      <title>Locations Near You - The Counter</title>
      <link rel="shortcut icon" type="image/x-icon" href="https://olocdn.global.ssl.fastly.net/img/thecounter/favicon.ico?6579"/>
      <link rel="stylesheet" type="text/css" media="screen" href="https://olocdn.global.ssl.fastly.net/css/thecounter/site-6579.css" />
      <link rel="stylesheet" type="text/css" href="./css/search.css">
      <script type="text/javascript" language="javascript" src="https://olocdn.global.ssl.fastly.net/js/jquery-1.12.4.min.js"></script> 
      <script>window.jQuery || document.write('<script src="/Scripts/jquery-1.12.4.min.js">\x3C/script>')</script>
   </head>
   <body class="Order">
      <a tabindex="0" href="#ContentWrapper" class="sr-only sr-only-focusable skip-link">Skip to main content</a>
      <div id="OuterWrapper" class="Order">
         <div id="outer" class="Order ">
            <div class="inner">
               <div id="HeaderBar" role="banner">
                  <div id="TopBar">
                     <span id="Logo">
                     <a href="/home/"><span class="sr-only">The Counter Parent Site</span></a>
                     </span>
                     <div id="LoginRegisterLink" class="hidden">
                        New to The Counter? 
                        <a href="/user/register?url=%2Fvendor%2Fsearch%3FStreetAddress%3D95112%26mode%3DOrder">Create an account!</a>
                     </div>
                     <a class="pull-right" href="/user/login?url=%2Fvendor%2Fsearch%3FStreetAddress%3D95112%26mode%3DOrder" id="loginLink">Login</a>
                     <div class="custom-header-links pull-right ">
                        <!-- -->
                     </div>
                     <div class="clear"></div>
                  </div>
                  <div id="NavBar">
                     <ul role="navigation" aria-label="primary">
                        <li id="Home"><a href="/"><span>Home</span></a></li>
                        <li id="Browse" class="active"><a href="/vendor/search"><span>View Menus</span></a></li>
                        <li id="Register"><a href="/user/register?url=%2Fvendor%2Fsearch%3FStreetAddress%3D95112%26mode%3DOrder"><span>Create Account</span></a></li>
                        <li id="HowItWorks"><a href="/help"><span>How It Works</span></a></li>
                        <li id="FAQ"><a href="/faq"><span>FAQ</span></a></li>
                        <li id="BasketNavItem">
                        </li>
                     </ul>
                  </div>
               </div>
               <div class="Column12">
                 <div id="ContentWrapper">
                    <div id="VendorSearchResults">
                       <div>
                          <div id="locationFilters" class="clearfix">
                             <div id="location-attribute-filters">
                             </div>
                          </div>
                          <table id="VendorList">
                             <tbody>
                                <tr>
                                   <th>Name</th>
                                   <th>Price</th>
                                   <th>Option</th>
                                </tr>
                                <% if (data !== undefined ) { %>
                                   <% data.forEach(function(data) { %>
                                      <tr class="vendor" data-vendorid="<% data.restraunt_id %>" data-hasdispatch="false">
                                         <td>
                                            <a class="order-action" href="https://order.thecounter.com/menu/counter-santana-row">
                                            <strong><%= data.name %></strong>
                                            </a>
                                            <div class="streetaddress">
                                            </div>
                                         </td>
                                         <td>
                                            <%= data.price %><br>
                                            <br>
                                         </td>
                                         <td>
                                            <!-- <a href="/menu?id=<%= data.item_id %>" class="btn btn-default">Add to cart</a> -->
                                            <button class="vendor-action order-action add-cart" type="button" id="add_cart" value="<%= data.item_id %>" res_id= " <%= data.restraunt_id%>">Add to cart</button>
                                         </td>
                                      </tr>
                                   <% }); %>
                                <% } %>
                             </tbody>
                          </table>
                       </div>
                    </div>
                    <ul>
                    </ul>
                 </div>
               </div>
               <div class="Column3" id="scroller">
                 <div class="BasketViewContainer">
                   <div class="menu-basket-header clearfix">
                      <h2 class="pull-left">Order Contents</h2>
                   </div>
                   <ul id="BasketProducts">
                    <div id="add-remove" class="add-remove">
                      
                    </div>
                   </ul>
                   <div class="clearfix"></div>
                   <div id="BasketTotals" class="clearfix">
                      <dl class="summary">
                         <dt role="heading" aria-level="3">SUB TOTAL</dt>
                         <dd class="money">
                            $<span id="bSubTotal">0.00</span>
                         </dd>
                      </dl>
                   </div>
                   <script type="text/html" id="tax-row-tmpl">
                      <dl class="summary taxRow">
                          <dt role="heading" aria-level="3"></dt>
                          <dd class="money"></dd>
                      </dl>
                   </script>
                </div>
               </div>
            </div>
         </div>
      </div>
      <div id="OuterFooter"></div>
      <div id="PopupDialog" class="modal"></div>
      <div id="Tooltip" style="display:none"></div>
      <script type="text/javascript">
        $(".add-cart").on("click",function(){
          var item_id = this.value;
          var restraunt_id = this.getAttribute("res_id");
          console.log("res_id:"+this.getAttribute("res_id"))
          console.log("item_id:"+this.value)
          console.log("THIS WORKS")
          $.ajax({
            type: 'POST',
            url: 'http://demo8655652.mockable.io/cart',
            data: { 
             restraunt_id: restraunt_id, 
             item_id: item_id, 
            },
            dataType: "json",

            crossDomain: true,
            success: function (msg) {
               // console.log(msg[0])
               var element;
               $('#add-remove').empty()
               msg.forEach(function(value) {
                  //do something with values
                  console.log(value);
                  element = '<li><span class="quantity">1x</span>'+
                       '<span class="product">'+value.item_name+'</span>'+
                       '<span class="money">$'+value.price+'</span>'+
                       '<div class="controls"><span aria-hidden="true">[<!-- </span> <a href="javascript:OLO.Order.edit(672716372);">edit</a><span aria-hidden="true"> |'+  
                       '--></span>'+
                          '<a href="javascript:OLO.Order.delete(672716372);">remove</a> <span aria-hidden="true">]</span>'+
                       '</div>'+
                       '<div class="options"></div></li>';

                $("#bSubTotal").html(value.total)
                $("#add-remove").append(element);
               console.log(element);
              });
               /*var element = '<li><span class="quantity">1x</span>'+
                       '<span class="product">Shishito Peppers</span>'+
                       '<span class="money">$6.50</span>'+
                       '<div class="controls"><span aria-hidden="true">[<!-- </span> <a href="javascript:OLO.Order.edit(672716372);">edit</a><span aria-hidden="true"> |'+  
                       '--></span>'+
                          '<a href="javascript:OLO.Order.delete(672716372);">remove</a> <span aria-hidden="true">]</span>'+
                       '</div>'+
                       '<div class="options"></div></li>';*/
               // $("#BasketProducts").append(element);

            },
            error: function (request, status, error) {

               alert(error);
            }
         });
        });
      </script>
   </body>
</html>